YUI.add("moodle-block_messageteacher",function(e,t){M.block_messageteacher=M.block_messageteacher||{},M.block_messageteacher.form={overlay:"",init:function(e){this.Y=e,html='<a id="block_messageteacher_output_header" href="#"><img src="'+M.util.image_url("t/delete","moodle")+'" /></a>',this.overlay_close=e.Node.create(html),this.overlay=new e.Overlay({headerContent:this.overlay_close,bodyContent:"",id:"block_messageteacher_output",width:"400px",visible:!1,constrain:!0}),this.overlay.render(e.one(document.body)),this.overlay_close.on("click",this.overlay.hide,this.overlay),e.on("key",this.hide_response,this.overlay_close,"down:13",this),this.overlay_close.on("click",this.hide_response,this),e.all(".messageteacher_link").on("click",this.show_form,this)},show_response:function(t){e=this.Y,this.overlay.set("bodyContent",e.Node.create(t)),this.overlay.set("align",{node:e.one("#id_tutorlink_submit"),points:[e.WidgetPositionAlign.TL,e.WidgetPositionAlign.RC]}),this.overlay.show()},hide_response:function(){this.overlay.hide()},show_form:function(t){e=this.Y,t.target.preventDefault(),this.xhr=e.io(t.target.get("href"),{method:"GET",context:this,on:{success:function(t,n){response=e.JSON.parse(n.responseText),this.show_response(response.output),response.script.length>0&&((script=e.one("#messageteacher_dynamic_script"))&&script.remove(),el=document.createElement("script"),el.id="ilp_dynamic_script",el.textContent=response.script,document.body.appendChild(el)),e.one("#mform1").on("submit",M.block_messageteacher.submit_form())},failure:function(e,t){this.show_response(t.responseText)}}})},submit_form:function(t){e=this.Y,t.target.preventDefault(),this.xhr=e.io(t.target.get("action"),{method:"POST",context:this,form:t.target,on:{success:function(t,n){response=e.JSON.parse(n.responseText),this.show_response(response.output)},failure:function(e,t){this.show_response(t.responseText)}}})}}},"@VERSION@");
